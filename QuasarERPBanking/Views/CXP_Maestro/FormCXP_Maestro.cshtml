@using QuasarERPBanking.Models
@model CXP_MAESTRO


@{
    var lstRamo = RAMOS.GetRamos();
    var lstRelac = CXP_RELAC.GetRelaciones();
    var lstFrmPago = FORMAPAGO.GetFormaPago();
    var lstCond = CONDICIONES.GetCondicion();
    var lstEdo = ESTADOS.GetEstados();
    var lstTpoPersona = TPOPERSONA.GetTpoPersona();
    var lstiva = CXP_MAESTRO.GetIva();


    //var message = Resources.StringResources;

}
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/scripts/Funciones.js")" type="text/javascript"></script>

@Html.AntiForgeryToken()
@Html.ValidationSummary(true)
<div class="internal-window bg-light">
    <div class="form--section-title col-md-12">
        <div class="col-md-6 internal--title">
            <h2 class="internal--title-h2">@Resources.CXP_MAESTRO.StringResources.tittleventana</h2>
        </div>

        <div class="col-md-6 icon-bar">
            <ul class="list-unstyled d-flex justify-content-around">
                <li class="icon--bar-create">
                    <a href="#" onclick="window.location.href = '/CentrodeCostoInterno/Create';">
                        <img src="~/Content/imagenes/icon-add.svg" width="20" height="24" />
                    </a>
                </li>
                <li class="icon--bar-search">
                    <a href="#" id="buscar" onclick="window.location.href = '/CentrodeCostoInterno/Index'; ">
                        <img src="~/Content/imagenes/icon-search.svg" width="20" height="24" />
                    </a>
                </li>
                <li class="icon--bar-delete">
                    <a href="#" onclick="eliminar();">
                        <img src="~/Content/imagenes/icon-delete.svg" width="20" height="24" />
                    </a>
                </li>
                <li class="icon--bar-save">
                    <a href="#">
                        <img src="~/Content/imagenes/icon-save.svg" width="24" height="24" />
                    </a>
                </li>
                <li class="icon--bar-exit">
                    <a href="/">
                        <img src="~/Content/imagenes/icon-door_open_exit.svg" width="24" height="24" />
                    </a>
                </li>
            </ul>
            <!-------------------------------------                 BOTONES DE ACTIVIDADES                  -------------------------------------->
            @*<img src="../../Content/themes/base/images/reloj.png" alt="Salir" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonSalir" onclick="showActivities();" id="actReunion" />*@
        </div>
    </div>




    <script>
        function eliminar() {
            if ($("#CXPCOD").val() != "") {
                var resp = confirm("¿" + '@Resources.CXP_MAESTRO.StringResources.msgDeleteProv ' + $("#CXPCOD").val().toUpperCase() + " ?");
                if (resp) {
                    $(location).attr("href", "/CXP_MAESTRO/Delete?cxpcod=" + $("#CXPCOD").val())
                    $("#CXPCOD").val("");
                }
                else {
                }
            }
            else {
                alert('@Resources.CXP_MAESTRO.StringResources.msgDeleteFail');
            }
        }
    </script>



    @*<div class="icon-bar">*@
    @*<img src="../../Content/themes/base/images/new-icon.png" alt="Nuevo" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttoNew" onclick="window.location.href = '/CXP_MAESTRO/Create';" />
        <img id="buscar" src="../../Content/themes/base/images/search-icon.png" alt="Buscar" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonBuscar" onclick="inhabilitartodo(); window.location.href = '/CXP_MAESTRO/Index';" />
        <img src="../../Content/themes/base/images/delete-icon.png" alt="Eliminar" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonDel" onclick="eliminar();" />
        <img src="../../Content/themes/base/images/save-icon.png" alt="Guardar" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonUp" onclick="submitform('myform');" />
        <img src="../../Content/themes/base/images/exit-icon.png" alt="Salir" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonSalir" onclick="window.location.href ='/';" />*@
    <!-------------------------------------                 BOTONES DE ACTIVIDADES                  -------------------------------------->
    @*<img src="../../Content/themes/base/images/help-window-xp-icon.png" alt="Salir" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonSalir" onclick="window.location.href ='/';" id="actLlamada"/>*@
    @* <img src="../../Content/themes/base/images/reloj.png" alt="Salir" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonSalir" onclick="showActivities();" id="actReunion" />*@
    @*<img src="../../Content/themes/base/images/help-window-xp-icon.png" alt="Salir" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonSalir" onclick="window.location.href ='/';" id="actRecibida" />
        <img src="../../Content/themes/base/images/help-window-xp-icon.png" alt="Salir" title="@Resources.CXP_MAESTRO.StringResources.tittlebuttonSalir" onclick="window.location.href ='/';" id="actEnviada" />*@



    @*</div>*@


    <div class="form--section col-md-12 my-4">

        <div class="form--section-search col-md-6">
            <label style="color:black" class="limpiar py-2 Font-Q"><b>@Resources.CXP_MAESTRO.StringResources.lblBusqueda</b></label>

            <!--Html.TextBoxFor(model => model.CXPCOD, new { style = " width:100px;"})-->
            <input type="text" id="CXPCOD_" data-autocomplete="@Url.Action("getCodigos2", "CXP_MAESTRO")"
                   autocomplete="on" class="radius form-control form--section-input Font-Q" />
        </div>

        <div class="form--section-condition col-md-6">
            @Html.LabelFor(model => model.CXPCOND, new { @class = "limpiar py-2 Font-Q" })

            @Html.DropDownListFor(model => model.CXPCOND, ((IEnumerable<CONDICIONES>)lstCond)/*For(model => model.CXPRELAC,*/
            .Select(option => new SelectListItem
            {
                Text = (option == null ? "Ninguno" : option.CONDICION.ToUpper()),
                Value = option.CONDICION.ToString(),/* Selected =Model != null && Model.CXPRELAC != null && option.CXPRELAC == Model.CXPRELAC*/
            })
            , Resources.CXP_MAESTRO.StringResources.placCondicion,
            new
            {
                @onchange = "",
                title = "Seleccione una Condición",
                @class = "limpiar form-control form-select form--section-input Font-Q"
            })
        </div>

        @*<div id="imagen" style="height:100px; width:450px">
                <img src="../../Content/themes/base/images/banner2.png" width="420" height="90" />
                <div id="text" style="color:white; width:400px; text-align:center; padding:0px 0px 0px 10px;">
                    <b>@Resources.CXP_MAESTRO.StringResources.BannerCxpMaestro</b>
                </div>
            </div>*@


    </div>
    @* \\\\\\\\\\\\\\\\\\\\\\\\ MENUS DE PESTAÑAS

        <div id="menupestanas">
            <ul id="tabs">
                <li id="LiCuenta" onclick="setCuentas();"><a>@Resources.CXP_MAESTRO.StringResources.liCuenta</a></li>
                <li id="LiContacto" onclick="setContactos();"><a>@Resources.CXP_MAESTRO.StringResources.liContacto</a></li>
                <li id="LiActividad" onclick="setActividades();"><a>@Resources.CXP_MAESTRO.StringResources.liActividad</a></li>
            </ul>
        </div>*@
    <div id="Cuentas" class="col-md-12 cuenta">

        <ul class="nav nav-tabs">
            <li id="LiCuenta" onclick="setCuentas();" class="nav-item">
                <a class="nav-link active limpiar dato-cliente Font-Q" data-bs-toggle="tab">@Resources.CXP_MAESTRO.StringResources.FieldsetProveedor</a>
            </li>
            <li id="LiContacto" onclick="setContactos();" class="nav-item">
                <a class="nav-link limpiar dato-cliente Font-Q" data-bs-toggle="tab" >@Resources.CXP_MAESTRO.StringResources.liContacto </a>
            </li>
            <li id="LiActividad" onclick="setActividades();" class="nav-item">
                <a class="nav-link limpiar dato-cliente Font-Q" data-bs-toggle="tab">@Resources.CXP_MAESTRO.StringResources.liActividad</a>
            </li>
        </ul>

        <div class="nav nav-tabs">



            @*<h3 class="limpiar dato-cliente my-2 pb-2 Font-Q"></h3>*@
        </div>

        <div class="form--section row g-2">
            <div class="col-xl-2 pb-2">
                <b>@Html.LabelFor(model => model.CXPCOD, new { style = "color:blue", @class = "limpiar py-2 Font-Q" })</b>
                <!--input type="text" id="CXPCOD"  style="width:100px;" /-->
                @Html.TextBoxFor(model => model.CXPCOD, new { style = ";", @class = "limpiar form-control Font-Q" })
            </div>

            <div class="col-xl-8 pb-2">
                @Html.LabelFor(model => model.CXPNOMBRE, new { @class = "limpiar py-2 Font-Q" })
                @Html.TextBoxFor(model => model.CXPNOMBRE, new { @class = "limpiar form-control Font-Q" })
            </div>

            <div class="col-xl-4 pb-2">
                @Html.LabelFor(model => model.CXPDIR, new { @class = "limpiar py-2 Font-Q" })
                <!--input type="text" name="CXPDIR" -->
                @Html.TextAreaFor(model => model.CXPDIR, new { style = "resize:none;", @class = "limpiar form-control Font-Q", @cols = 30, @rows = 6 })
            </div>

            <div class="col-xl-6">
                <div class="row g-2">
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPWEB, new { @class = "limpiar py-1 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPWEB, new { @class = "limpiar form-control Font-Q" })
                    </div>
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPNIT, new { @class = "limpiar py-1 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPNIT, new { style = "size:15", @class = "limpiar form-control Font-Q" })
                    </div>
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPRIF, new { @class = "limpiar py-1 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPRIF, new { style = "size:12; ", @class = "limpiar form-control Font-Q", @onkeyup = "this.value=this.value.toUpperCase();" })
                    </div>
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPEDO, new { @class = "limpiar py-1 Font-Q" })

                        @Html.DropDownListFor(model => model.CXPEDO, ((IEnumerable<ESTADOS>)lstEdo)/*For(model => model.CXPRELAC,*/
                        .Select(option => new SelectListItem
                        {
                        Text = (option == null ? "Ninguno" : option.ESTADO.ToUpper()),
                        Value = option.ESTADO.ToString(),
                        /* Selected =Model != null && Model.CXPRELAC != null && option.CXPRELAC == Model.CXPRELAC*/
                        })
                        , Resources.CXP_MAESTRO.StringResources.placEdoCXP, new
                             {
                                 @onchange = "",
                                 style = "",
                                 title = "Seleccione un Estado",
                            @class = "limpiar form-control form-select Font-Q",
                            @placeholder = Resources.CXP_MAESTRO.StringResources.placEdoCXP
                             })
                    </div>
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPCIUDAD, new { @class = "limpiar py-1 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPCIUDAD, new { style = "size=12", @class = "limpiar form-control Font-Q" })
                    </div>
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPCODPOSTAL, new { @class = "limpiar py-1 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPCODPOSTAL, new { style = "size=15", @class = "limpiar form-control Font-Q" })
                    </div>
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPRAMO, new { @class = "limpiar py-1 Font-Q" })
                        @Html.DropDownListFor(model => model.CXPRAMO, ((IEnumerable<RAMOS>)lstRamo).Select(option => new SelectListItem
                   {
                       Text = (option == null ? "Ninguno" : option.RAMNOMBRE.ToUpper()),
                       Value = option.RAMNOMBRE.ToString(),
                       /* Selected =Model != null && Model.CXPRELAC != null && option.CXPRELAC == Model.CXPRELAC*/
                   }), Resources.CXP_MAESTRO.StringResources.placRamo, new
                   {
                       @onchange = "",
                       style = "",
                       title = "Seleccione el Ramo",
                       @class = "limpiar form-control form-select Font-Q"
                   })

                    </div>
                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPFAX, new { @class = "limpiar py-1 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPFAX, new { style = "", @class = "limpiar form-control Font-Q" })

                    </div>

                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPTELF, new { @class = "limpiar py-1" })
                        @Html.TextBoxFor(model => model.CXPTELF, new { style = "", @class = "limpiar form-control Font-Q" })

                    </div>


                </div>

            </div>


            <div class="col-xl-4 pb-2">
                @Html.LabelFor(model => model.CXPWEB, new { @class = "limpiar py-2 Font-Q" })
                @Html.TextBoxFor(model => model.CXPWEB, new { style = "size=40; ", @class = "limpiar form-control Font-Q" })
            </div>

            <div class="col-xl-2 pb-2">
                @Html.LabelFor(model => model.CXPRELAC, new { @class = "limpiar py-2 Font-Q" })
                @Html.DropDownListFor(model => model.CXPRELAC, ((IEnumerable<CXP_RELAC>)lstRelac)/*For(model => model.CXPRELAC,*/
                .Select(option => new SelectListItem
                {
                    Text = (option == null ? "Ninguno" : option.CXPRELAC.ToUpper()),
                    Value = option.CXPRELAC.ToString(),
                    /* Selected =Model != null && Model.CXPRELAC != null && option.CXPRELAC == Model.CXPRELAC*/
                })
                , Resources.CXP_MAESTRO.StringResources.placRelacion, new
                     {
                    @onchange = "",
                         title = "Seleccione la relación",
                    @class = "limpiar form-control form-select Font-Q"
                })
            </div>
            <div class="col-xl-2 pb-2">
                @Html.LabelFor(model => model.CXPRELACDESDE, new { @class = "limpiar py-2 Font-Q" })
                <!--{  type ="datetime-local", class= "form-control datepicker", placeholder="Introduzca la fecha aquí." }) readonly = true-->
                @Html.TextBoxFor(model => model.CXPRELACDESDE, "{0:MM/dd/yyyy}", new
                {
                    @type = "datetime-local",
                    @class = "form-select form-control datepicker limpiar Font-Q",
                    placeholder = "Introduzca la fecha aquí."
                })
                @*@Html.TextBox( "idzzz ", Util.);)*@

            </div>


            <div class="col-xl-12 row g-2">

                <h3 class="limpiar dato-cliente my-2 pb-2">@Resources.CXP_MAESTRO.StringResources.FieldsetFinanciero</h3>
                <div class="col-xl-12 row g-2">
                    <div class="col-xl-2 ">
                        @Html.LabelFor(model => model.CXPFRMP, new { @class = "limpiar py-2 Font-Q" })

                        @Html.DropDownListFor(model => model.CXPFRMP, ((IEnumerable<FORMAPAGO>)lstFrmPago)
                        .Select(option => new SelectListItem
                        {
                            Text = (option == null ? "Ninguno" : option.DESCRIPCION.ToUpper()),
                            Value = option.DESCRIPCION.ToString(),
                            /* Selected =Model != null && Model.CXPRELAC != null && option.CXPRELAC == Model.CXPRELAC*/
                        })
                       , Resources.CXP_MAESTRO.StringResources.placFormPago, new
                       {
                           onclick = "Clicked(@item.ID);",
                           @onchange = "",
                           title = "Seleccione la forma de pago",
                           @class = "limpiar form-control form-select Font-Q"
                       })

                    </div>
                    <div class="col-xl-2">
                        @Html.LabelFor(model => model.CXPNCTA, new { @class = "limpiar py-2 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPNCTA, new
                        {
                            style = "size=20;",
                            @class = "limpiar form-control Font-Q",
                            onkeypress = "return isNumberKey(event)"
                        })
                    </div>
                    <div class="col-xl-2 pb-2">
                        @Html.LabelFor(model => model.CXPDIASCRED, new { @class = "limpiar py-2 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPDIASCRED, new
                        {
                            @class = "limpiar form-control",
                            onkeypress = "return isNumberKey(event)"
                        })
                    </div>

                    <div class="col-xl-4 pb-2">
                        @Html.LabelFor(model => model.CXPRESENIA, new { @class = "limpiar" })
                        @Html.TextAreaFor(model => model.CXPRESENIA, new { style = "resize:none;", @class = "limpiar form-control Font-Q", @cols = 125, @rows = 2 })
                    </div>


                </div>

                <div class="col-xl-12 row g-2">
                    <div class="col-xl-2 pb-2">
                        @Html.LabelFor(model => model.CXPCTAMAY, new { @class = "limpiar py-2 Font-Q" })
                        @Html.TextBoxFor(model => model.CXPCTAMAY, new
                   {
                       maxlength = "20",
                       size = "20",
                       @class = "limpiar form-control Font-Q"
                   })
                    </div>

                    <div class="col-xl-2">
                        @Html.LabelFor(model => model.CXPTPOPERS, new { @class = "limpiar py-2 Font-Q" })
                        @Html.DropDownListFor(model => model.CXPTPOPERS, ((IEnumerable<TPOPERSONA>)lstTpoPersona)/*For(model => model.CXPRELAC,*/
                        .Select(option => new SelectListItem
                        {
                            Text = (option == null ? "Ninguno" : option.TPOPERSON.ToUpper()),
                            Value = option.CODIGO.ToString(),
                            /* Selected =Model != null && Model.CXPRELAC != null && option.CXPRELAC == Model.CXPRELAC*/
                        })
                        , Resources.CXP_MAESTRO.StringResources.placTipPersona, new
                        {
                            @onchange = "",
                            title = "Seleccionar Tipo de Persona",
                            @class = "limpiar form-control form-select Font-Q"
                        })

                    </div>

                    <div class="col-xl-2 pb-2">
                        @Html.LabelFor(model => model.CXPRETENC, new { @class = "limpiar py-2 Font-Q" })
                        @Html.DropDownListFor(model => model.CXPRETENC, lstiva, new
                        {
                            @class = "limpiar form-control form-select Font-Q",
                       style = "font-size:13px"
                        })
                    </div>

                    <div class="col-xl-4 mb-4">
                        <label class="Font-Q"> @Resources.CXP_MAESTRO.StringResources.lblimpuesto</label>
                        <div class="space-x-2">
                            <div class="form-check form-check-inline">

                                @Html.CheckBoxFor(model => model.CXPITF, new { style = "size=30", @class = "limpiar Font-Q" })
                                @Html.LabelFor(model => model.CXPITF, new { @class = "limpiar py-2 Font-Q" })
                            </div>



                            <div class="form-check form-check-inline">
                                @Html.CheckBoxFor(model => model.CXPIMPMUN, new { style = "size=30", @class = "limpiar Font-Q" })
                                @Html.LabelFor(model => model.CXPIMPMUN, new { @class = "limpiar py-2" })
                            </div>



                            <div class="form-check form-check-inline">
                                @Html.CheckBoxFor(model => model.CXPTIMBRE, new { style = "size=30", @class = "limpiar Font-Q" })
                                @Html.LabelFor(model => model.CXPTIMBRE, new { @class = "limpiar py-2 Font-Q" })
                            </div>
                        </div>
                    </div>


                </div>







            </div>

        </div>




        <fieldset class="ventana">
            <legend class="limpiar"><b></b></legend>

        </fieldset>
    </div>
    <div id="Contactos">
        @using (Html.BeginForm("Edit", "CXP_CONTACTOS", FormMethod.Post, new { id = "myForm" }))
        {
            if (Model != null)
            {
                ViewData.Add("CXPCOD", Model.CXPCOD);
            }
            Html.RenderPartial("frmContactos", new CXP_CONTACTOS());
        }
    </div>

    <div id="Actividades">
        @using (Html.BeginForm("Edit", "CXP_ACTIVIDADES", FormMethod.Post, new { id = "myForm" }))
        {
            if (Model != null)
            {
                //ViewData.Add("CXPCOD", Model.CXPCOD);
            }
            CXP_ACTIVIDADES cxp_actividad = new CXP_ACTIVIDADES
            {
                //ACTID = "1",
                //ACT_ASUNTO = "aaaa",

            };
            List<CXP_ACTIVIDADES> lstActividades = new List<CXP_ACTIVIDADES>();
            //lstActividades.Add(cxp_actividad);
            if (Model != null)
            {
                lstActividades = CXP_ACTIVIDADES.ActividadesPorCXPCOD(Model.CXPCOD != null ? Model.CXPCOD : "0");
            }
            Html.RenderPartial("gridActividades", new CXP_ACTIVIDADES());
        }
    </div>
</div>
@Html.ValidationSummary()
<script type="text/javascript">


    $("#CXPCOD").numericInput();
    $("#CXPNIT").numericInput();
    $("#CXPCODPOSTAL").numericInput();
    //$("#CXPFAX").numericInput();




    //href contactos y actividades para modificar y agregar

    function showContact(indice) {
        var fila = $('#tblContactos tbody tr').eq(indice);
        var tds = fila.find("td");             // Finds all children <td> elements
        $("#CXPCONTCOD").val(tds.eq(0).text());
        $("#CXPCONTNOM").val(tds.eq(1).text());
        $("#CXPCONTTEL").val(tds.eq(2).text());
        $("#CXPCONTFAX").val(tds.eq(3).text());
        $("#CXPCONTEMAIL").val(tds.eq(4).text());
        $("#CXPCONTDIR").val(tds.eq(5).text());
        $("#CXPCONTSEL").val(tds.eq(6).text()),
        //$.each(tds, function() {               // Visits every single <td> element
        //    alert($(this).text());
        //    // Prints out the text within the <td>
        //});
        $("#CXPCONTCOD").prop('readonly', "true");
        $("#action").val("Edit");
        showDlgContact();
    }

    function showActivities(indice) {



        var fila = $('#gridContent  tbody  tr').eq(indice);
        var tds = fila.find("td");             // Finds all children <td> elements
        $("#ACTID").val(tds.eq(0).text());
        $("#ACT_AUTOR").val(tds.eq(1).text());
        $("#ACT_FECHCREA").val(tds.eq(2).text());
        $("#ACT_FECHREAL").val(tds.eq(3).text());
        $("#ACT_CUERPO").val(tds.eq(5).text());
        $("#ACT_ASUNTO").val(tds.eq(4).text());
        $("#ACT_PERSCOMP").val(tds.eq(6).text());
        $("#lblName").text($("#CXPNOMBRE").val());


        //$("ACT_CXPCOD").val(tds.eq(0).text());
        //$("ACT_PERSOUR").val(tds.eq(0).text());
        //$("ACT_DESC").val(tds.eq(0).text());
        //$("ACT_CORSRES").val(tds.eq(0).text());
        //$("ACT_CORATN").val(tds.eq(0).text());
        //$("ACT_CORTPO").val(tds.eq(0).text());
        //$("ACT_ADJ").val(tds.eq(0).text());

        $("#ACTID").prop('readonly', "true");
        $("#ACT_FECHCREA").prop('readonly', "true");
        $("#ACT_AUTOR").prop('readonly', "true");
        $("#action").val("Edit");
        showDlgActivities();
    }

    //para bloquear las pestañas de cxpmaestro
    function setCuentas() {
        $("#Cuentas").show();
        $("#Contactos").hide();
        $("#Actividades").hide();
    }

    function setContactos() {
        if ($("#CXPCOD").val() != "" && $("#CXPCOD").val() != null) {
            $("#Cuentas").hide();
            $("#Actividades").hide();
            $("#Contactos").show();
        }
    }

    function setActividades() {
        if ($("#CXPCOD").val() != "" && $("#CXPCOD").val() != null) {
            $("#Cuentas").hide();
            $("#Contactos").hide();
            $("#Actividades").show();
        }
    }


    //$.datepicker.regional['pt-BR'] = {
    //    closeText: 'Fechar',
    //    prevText: 'Anterior',
    //    nextText: 'Próximo',
    //    currentText: 'Hoje',
    //    monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
    //    'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
    //    monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun',
    //    'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
    //    dayNames: ['Domingo', 'Segunda-feira', 'Terça-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sabado'],
    //    dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'],
    //    dayNamesMin: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'],
    //    weekHeader: 'Sm',
    //    dateFormat: 'dd/mm/yy',
    //    firstDay: 0,
    //    isRTL: false,
    //    showMonthAfterYear: false,
    //    yearSuffix: ''
    //    //showOn: 'button',
    //    //buttonImage: 'images/calendar.png',
    //    //buttonImageOnly: true
    //};

    //$.datepicker.regional['es-VE'] = {
    //    closeText: 'Cerrar',
    //    prevText: '< Ant',
    //    nextText: 'Sig >',
    //    currentText: 'Hoy',
    //    monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
    //    monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
    //    dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
    //    dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mié', 'Juv', 'Vie', 'Sáb'],
    //    dayNamesMin: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sá'],
    //    weekHeader: 'Sm',
    //    dateFormat: 'dd/mm/yy',
    //    firstDay: 1,
    //    isRTL: false,
    //    showMonthAfterYear: false,
    //    yearSuffix: ''
    //};
    //$.datepicker.regional['en-US'] = {  };
    @*$.datepicker.setDefaults($.datepicker.regional["@QuasarERPBanking.Models.ParametrosGlobales.culture"]);*@

    ////////////////////////////////////////////////////////////////////////////////////////////
    ///////// LOAD_PAGE ////////////////////////////////////////////////////////////////////////
    $(function () {

        //$('select').select2();
        //$('.selection option').css('font-size', '15px');




        $("#CXPRIF").change(function () {
            var _this = $("#CXPRIF");
            var _email = $("#CXPRIF").val();

            var re = /^[a-zA-Z]{1,1}[0-9]{9,11}$/;
            var valid = re.test(_email);

            if (valid) {
                _this.attr('style', 'background:white');
            } else {
                _this.attr('style', 'background:#fc080833');
                alert('@Resources.MANTENIMIENTO.StringResources.msgJQRif');
                $("#CXPRIF").val("");
                //$("#CXPRIF").focus();

            }
        });

        $("#CXPFAX").change(function () {
            var _this = $("#CXPFAX");
            var _email = $("#CXPFAX").val();

            var re = /^[0-9-+()]{1,16}$/;
            var valid = re.test(_email);

            if (valid) {
                _this.attr('style', 'background:white');
            } else {
                _this.attr('style', 'background:#fc080833');
                alert('@Resources.MANTENIMIENTO.StringResources.msgJQFax');
                $("#CXPFAX").val("");
                //$("#CXPRIF").focus();

            }
        });

        $("#CXPTELF").blur(function () {
            var _this = $("#CXPTELF");
            var _email = $("#CXPTELF").val();

            var re = /^[0-9-+()]{1,16}$/;
            var valid = re.test(_email);

            if (valid) {
                _this.attr('style', 'background:white');
            } else {
                _this.attr('style', 'background:#fc080833');
                alert('@Resources.MANTENIMIENTO.StringResources.msgJQTelf');
                $("#CXPTELF").val("");
                //$("#CXPRIF").focus();

            }
        });




        ////  ocultar botones de actividades
        $("#actLlamada").hide();
        $("#actReunion").hide();
        $("#actRecibida").hide();
        $("#actEnviada").hide();


        //////  PARA QUE LAS PESactEnviada" TAÑAS QUEDEN ACTIVAS Y CAMBIEN DE COLOR
        $("#menupestanas li").click(function () {
            //$(this).hide();
            $("#menupestanas li").removeClass("activo"); //Remove any "active" class
            $(this).addClass("activo"); //Add "active" class to selected tab
            $(".tab_content").hide(); //Hide all tab content
            var activeTab = $(this).find("a").attr("href"); //Find the href attribute value to
            $(activeTab).fadeIn(); //Fade in the active ID content
            return false;
        });

        //
        //$("a#To").each(function () {
        //    this.click(function () {
        //        e.preventDefault();
        //        //$("#splash").op();
        //    });
        //});

        //  PARA HABILITAR O INHABILITAR EL CAMPO DEPENDIENDO DEL TIPO DE TRANSACCION
        $("#CXPFRMP").change(function () {
            if ($(this).val() == "Abono a Cuenta") {
                $("#CXPNCTA").prop("readonly", false);
                $("#CXPNCTA").val("");
            }
            else {
                $("#CXPNCTA").prop("readonly", true);
                $("#CXPNCTA").val("-");
            }
        });

        loadDatePicker();
        $.datepicker.setDefaults($.datepicker.regional["@QuasarERPBanking.Models.ParametrosGlobales.culture"]);

        $('.datepicker').datepicker(
        {
            //format: 'dd/mm/yy',
            //startDate: '-3d',
            onSelect: function () {
                //return $(this).trigger('change');
                //alert("prueba");
            }
        }); //Initialise any date pickers



        $("#CXPCOD").focusout(function () {

            if (!$("#CXPCOD").prop('readonly')) {
                $.ajax({
                    url: "/CXP_MAESTRO/getCodigo?term=" + $("#CXPCOD").val(),
                    success: function (data) {
                        if (data == "1") {
                            alert("El código ya existe");
                            inhabilitartodo();
                            $("#CXPCOD").prop('disabled', false);
                        }
                        else {
                            habilitartodo();
                        }
                    }
                });
            }

        });

        // AUTOCOMPLE Y LLENADO
        $("#CXPCOD_").each(function () {
            $("#CXPCOD_").autocomplete({
                source: $(this).attr("data-autocomplete"),
                minLength: 3,
                select: function (event, ui) {
                    if (ui.item) {

                        $.ajax({
                            url: "/CXP_MAESTRO/getCodAutocom?term=" + ui.item.value,
                            success: function (data) {

                                habilitartodo();
                                //window.location.replace("/CXP_MAESTRO/Edit?cxp_maestro=" + data);

                                $("#CXPCOND").val(data.CXPCOND);
                                $("#CXPNOMBRE").val(data.CXPNOMBRE);
                                $("#CXPDIR").val(data.CXPDIR);
                                $("#CXPWEB").val(data.CXPWEB);
                                $("#CXPRELACDESDE").val(data.strCXPRELACDESDE);
                                $("#CXPRETENC").val(data.CXPRETENC);
                                $("#CXPCOMPRADOR").val(data.CXPCOMPRADOR);
                                $("#CXPNIT").val(data.CXPNIT);
                                $("#CXPRIF").val(data.CXPRIF);
                                $("#CXPEDO").val(data.CXPEDO);
                                $("#CXPCIUDAD").val(data.CXPCIUDAD);
                                $("#CXPCODPOSTAL").val(data.CXPCODPOSTAL);
                                $("#CXPRAMO").val(data.CXPRAMO);
                                $("#CXPFAX").val(data.CXPFAX);
                                $("#CXPTELF").val(data.CXPTELF);
                                $("#CXPDIASCRED").val(data.CXPDIASCRED);
                                $("#CXPBALACT").val(data.CXPBALACT);
                                $("#CXPRESENIA").val(data.CXPRESENIA);
                                $("#CXPCOD").val(data.CXPCOD);
                                $("#CXPRELAC").val(data.CXPRELAC);
                                $("#CXPCTAMAY").val(data.CXPCTAMAY);
                                $("#CXPFRMP").val(data.CXPFRMP);
                                $("#CXPNCTA").val(data.CXPNCTA);
                                $("#CXPNCTA").val() == "-" ? $("#CXPNCTA").prop('readonly', true) : $("#CXPNCTA").prop('readonly', false);
                                $("#CXPSEL").val(data.CXPSEL);
                                $("#CXPTPOPERS").val(data.CXPTPOPERS);
                                $("#CXPGRUPO").val(data.CXPGRUPO);
                                $("#CXPITF").prop('checked', data.CXPITF);
                                $("#CXPCATEGORIA").val(data.CXPCATEGORIA);
                                $("#CXPTIMBRE").prop('checked', data.CXPTIMBRE);
                                $("#CXPIMPMUN").prop('checked', data.CXPIMPMUN);
                                $("#CXPCOD_").val("");
                                $("#CXPCOD").prop('readonly', true);

                                $("#Cuenta > fieldset > legend").html('@Resources.CXP_CONTACTOS.StringResources.FieldsetCont' + " - " + data.CXPCOD + "-" + data.CXPNOMBRE);
                                //carga las pestañas por codigo
                                loadContacts(data.CXPCOD);
                                loadActivities(data.CXPCOD);

                                //aparecen los botondes de actividades
                                $("#actLlamada").show();
                                $("#actReunion").show();
                                $("#actRecibida").show();
                                $("#actEnviada").show();
                            }
                        });
                    }
                    else {
                        alert('@Resources.MANTENIMIENTO.StringResources.msgJQError');
                    }
                },
                error: function () {
                    alert('@Resources.MANTENIMIENTO.StringResources.msgJQAutoc');   // remember to call response() even if ajax failed
                }
            });
        });

        $("#buscar").click(function () {
            //$(location).attr("href", "/CXP_MAESTRO/Buscar?cxpcod=" + $("#CXPCOD_").val());

            $("#CXPCOD_").prop('disabled', false);
            $("#CXPCOD_").val("");
            $(".limpiar").val("");
            $(".limpiar").prop('checked', false);

        });



        ///////////// contador de caracteres para los textarea//////////////////////
        //$("#CXPDIR").charCounter(170, {
        //    container: '<em id="a" style="font:15px Arial Narrow; color:#ccc; position:relative; bottom:20px; left:190px"></em>',
        //    format: "170 / %1",
        //    pulse: false,
        //    delay: 100,
        //});

        //$("#CXPRESENIA").charCounter(170, {
        //    container: '<em id="a" style="font:15px Arial Narrow; color:#ccc; position:relative; bottom:20px; left:759px"></em>',
        //    format: "170 / %1",
        //    pulse: false,
        //    delay: 100,
        //});


    })



    function loadContacts(CXPCOD) {
        $.ajax({
            url: "/CXP_CONTACTOS/getContactos?cxpcod=" + CXPCOD,
            success: function (tabla) {
                $('#tblContactos  tbody  tr').remove();
                $('#tblContactos').append(tabla);
            }
        });
    }

    function loadActivities(CXPCOD) {
        $.ajax({
            url: "/CXP_ACTIVIDADES/getActividades?cxpcod=" + CXPCOD,
            success: function (tabla) {
                $('#gridContent  tbody  tr').remove();
                $('#gridContent tbody:last').append(tabla);
            }
        });
    }
    function habilitartodo() {
        $("#CXPCOND").prop('disabled', false);
        $("#CXPNOMBRE").prop('disabled', false);
        $("#CXPDIR").prop('disabled', false);
        $("#CXPWEB").prop('disabled', false);
        $("#CXPRELACDESDE").prop('disabled', false);
        $("#CXPRETENC").prop('disabled', false);
        $("#CXPCOMPRADOR").prop('disabled', false);
        $("#CXPNIT").prop('disabled', false);
        $("#CXPRIF").prop('disabled', false);
        $("#CXPEDO").prop('disabled', false);
        $("#CXPCIUDAD").prop('disabled', false);
        $("#CXPCODPOSTAL").prop('disabled', false);
        $("#CXPRAMO").prop('disabled', false);
        $("#CXPFAX").prop('disabled', false);
        $("#CXPTELF").prop('disabled', false);
        $("#CXPDIASCRED").prop('disabled', false);
        $("#CXPBALACT").prop('disabled', false);
        $("#CXPRESENIA").prop('disabled', false);
        $("#CXPCOD").prop('disabled', false);
        $("#CXPRELAC").prop('disabled', false);
        $("#CXPCTAMAY").prop('disabled', false);
        $("#CXPFRMP").prop('disabled', false);
        $("#CXPNCTA").prop('disabled', false);
        $("#CXPSEL").prop('disabled', false);
        $("#CXPTPOPERS").prop('disabled', false);
        $("#CXPGRUPO").prop('disabled', false);
        $("#CXPITF").prop('disabled', false);
        $("#CXPCATEGORIA").prop('disabled', false);
        $("#CXPTIMBRE").prop('disabled', false);
        $("#CXPIMPMUN").prop('disabled', false);

    }
    /// para las acciones de los botones de actividades
    $(function () {

        $("#actReunion").click(function () {
            //alert();
            $("#action").val("Create");
            $("#ACTID").removeAttr("readonly");
            $("#ACT_AUTOR").removeAttr("readonly");
            $("#ACT_FECHCREA").removeAttr("readonly");
            $("#ACT_AUTOR").val(data.usuario);


            //cleanA();
            showDlgActivities();
        });

    });

    @*$(document).ready(function () {
        //debugger;
        $("#CXPCOD_").autocomplete({
            source: function (request, response) {
                $.ajax(
                     '@Url.Action("getCodigos", "CXP_MAESTRO")', {
                         type: "POST",
                         dataType: "json",
                         data: { term: request.term },
                         success: function (data) {
                             response($.map(data, function (item) {
                                 return {
                                     label: item.CXPCOD + " - " + item.CXPNOMBRE,
                                     value: item.CXPCOD + " - " + item.CXPNOMBRE
                                 };
                             }))

                         }
                     })
            },
            minLength: 1,
            select: function (event, ui) {
            }
        });
    })*@



</script>
